package rs.raf.projekat_avg_ivan_bauk_rn6218.data.repositories.menus

import io.reactivex.Completable
import io.reactivex.Observable
import rs.raf.projekat_avg_ivan_bauk_rn6218.data.datasources.local.MenuDao
import rs.raf.projekat_avg_ivan_bauk_rn6218.data.models.menu.Menu
import rs.raf.projekat_avg_ivan_bauk_rn6218.data.models.menu.MenuEntity

class MenuRepositoryImpl(
    private val localDataSource: MenuDao
) : MenuRepository {

    override fun getAll(): Observable<List<Menu>> {
        return localDataSource
            .getAll()
            .map {
                it.map {
                    Menu(
                        it.idMenu,
                        it.strMenu,
                        it.strMenuThumb,
                        it.strCategory,
                        it.strDate,
                        it.strMenuCategory,
                        it.strInstructions,
                        it.strYoutube,
                        it.strIngredient1,
                        it.strIngredient2,
                        it.strIngredient3,
                        it.strIngredient4,
                        it.strIngredient5,
                        it.strIngredient6,
                        it.strIngredient7,
                        it.strIngredient8,
                        it.strIngredient9,
                        it.strIngredient10,
                        it.strIngredient11,
                        it.strIngredient12,
                        it.strIngredient13,
                        it.strIngredient14,
                        it.strIngredient15,
                        it.strIngredient16,
                        it.strIngredient17,
                        it.strIngredient18,
                        it.strIngredient19,
                        it.strIngredient20,
                        it.strMeasure1,
                        it.strMeasure2,
                        it.strMeasure3,
                        it.strMeasure4,
                        it.strMeasure5,
                        it.strMeasure6,
                        it.strMeasure7,
                        it.strMeasure8,
                        it.strMeasure9,
                        it.strMeasure10,
                        it.strMeasure11,
                        it.strMeasure12,
                        it.strMeasure13,
                        it.strMeasure14,
                        it.strMeasure15,
                        it.strMeasure16,
                        it.strMeasure17,
                        it.strMeasure18,
                        it.strMeasure19,
                        it.strMeasure20,
                        it.strCalories1,
                        it.strCalories2,
                        it.strCalories3,
                        it.strCalories4,
                        it.strCalories5,
                        it.strCalories6,
                        it.strCalories7,
                        it.strCalories8,
                        it.strCalories9,
                        it.strCalories10,
                        it.strCalories11,
                        it.strCalories12,
                        it.strCalories13,
                        it.strCalories14,
                        it.strCalories15,
                        it.strCalories16,
                        it.strCalories17,
                        it.strCalories18,
                        it.strCalories19,
                        it.strCalories20,
                        it.strCalories
                        )
                }
            }
    }

    override fun delete(id: String): Completable {
        return localDataSource.delete(id)
    }

    override fun insert(menu: Menu): Completable {
        val menuEntity = MenuEntity(
            menu.idMenu,
            menu.strMenu,
            menu.strMenuThumb,
            menu.strCategory,
            menu.strDate,
            menu.strMenuCategory,
            menu.strInstructions,
            menu.strYoutube,
            menu.strIngredient1,
            menu.strIngredient2,
            menu.strIngredient3,
            menu.strIngredient4,
            menu.strIngredient5,
            menu.strIngredient6,
            menu.strIngredient7,
            menu.strIngredient8,
            menu.strIngredient9,
            menu.strIngredient10,
            menu.strIngredient11,
            menu.strIngredient12,
            menu.strIngredient13,
            menu.strIngredient14,
            menu.strIngredient15,
            menu.strIngredient16,
            menu.strIngredient17,
            menu.strIngredient18,
            menu.strIngredient19,
            menu.strIngredient20,
            menu.strMeasure1,
            menu.strMeasure2,
            menu.strMeasure3,
            menu.strMeasure4,
            menu.strMeasure5,
            menu.strMeasure6,
            menu.strMeasure7,
            menu.strMeasure8,
            menu.strMeasure9,
            menu.strMeasure10,
            menu.strMeasure11,
            menu.strMeasure12,
            menu.strMeasure13,
            menu.strMeasure14,
            menu.strMeasure15,
            menu.strMeasure16,
            menu.strMeasure17,
            menu.strMeasure18,
            menu.strMeasure19,
            menu.strMeasure20,
            menu.strCalories1,
            menu.strCalories2,
            menu.strCalories3,
            menu.strCalories4,
            menu.strCalories5,
            menu.strCalories6,
            menu.strCalories7,
            menu.strCalories8,
            menu.strCalories9,
            menu.strCalories10,
            menu.strCalories11,
            menu.strCalories12,
            menu.strCalories13,
            menu.strCalories14,
            menu.strCalories15,
            menu.strCalories16,
            menu.strCalories17,
            menu.strCalories18,
            menu.strCalories19,
            menu.strCalories20,
            menu.strCalories
        )
        return localDataSource.insert(menuEntity)
    }

    override fun getAllMenusByCategory(category: String): Observable<List<Menu>> {
        return localDataSource
            .getByCategory(category)
            .map {
                it.map {
                    Menu(
                        it.idMenu,
                        it.strMenu,
                        it.strMenuThumb,
                        it.strCategory,
                        it.strDate,
                        it.strMenuCategory,
                        it.strInstructions,
                        it.strYoutube,
                        it.strIngredient1,
                        it.strIngredient2,
                        it.strIngredient3,
                        it.strIngredient4,
                        it.strIngredient5,
                        it.strIngredient6,
                        it.strIngredient7,
                        it.strIngredient8,
                        it.strIngredient9,
                        it.strIngredient10,
                        it.strIngredient11,
                        it.strIngredient12,
                        it.strIngredient13,
                        it.strIngredient14,
                        it.strIngredient15,
                        it.strIngredient16,
                        it.strIngredient17,
                        it.strIngredient18,
                        it.strIngredient19,
                        it.strIngredient20,
                        it.strMeasure1,
                        it.strMeasure2,
                        it.strMeasure3,
                        it.strMeasure4,
                        it.strMeasure5,
                        it.strMeasure6,
                        it.strMeasure7,
                        it.strMeasure8,
                        it.strMeasure9,
                        it.strMeasure10,
                        it.strMeasure11,
                        it.strMeasure12,
                        it.strMeasure13,
                        it.strMeasure14,
                        it.strMeasure15,
                        it.strMeasure16,
                        it.strMeasure17,
                        it.strMeasure18,
                        it.strMeasure19,
                        it.strMeasure20,
                        it.strCalories1,
                        it.strCalories2,
                        it.strCalories3,
                        it.strCalories4,
                        it.strCalories5,
                        it.strCalories6,
                        it.strCalories7,
                        it.strCalories8,
                        it.strCalories9,
                        it.strCalories10,
                        it.strCalories11,
                        it.strCalories12,
                        it.strCalories13,
                        it.strCalories14,
                        it.strCalories15,
                        it.strCalories16,
                        it.strCalories17,
                        it.strCalories18,
                        it.strCalories19,
                        it.strCalories20,
                        it.strCalories
                    )
                }
            }
    }
}